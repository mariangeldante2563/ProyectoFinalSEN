<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Temporal - DEBUG</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-info { background: #f0f0f0; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
        .warning { background: #fff3e0; color: #ef6c00; }
    </style>
</head>
<body>
    <h1>Dashboard Temporal - Diagn√≥stico</h1>
    
    <div id="session-info" class="debug-info">
        <h3>Informaci√≥n de Sesi√≥n</h3>
        <div id="session-details"></div>
    </div>

    <div id="token-info" class="debug-info">
        <h3>Informaci√≥n de Token</h3>
        <div id="token-details"></div>
    </div>

    <div id="user-info" class="debug-info">
        <h3>Informaci√≥n de Usuario</h3>
        <div id="user-details"></div>
    </div>

    <div id="storage-info" class="debug-info">
        <h3>LocalStorage Completo</h3>
        <div id="storage-details"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîç Iniciando diagn√≥stico del dashboard...');
            
            // Informaci√≥n de sesi√≥n
            const currentSession = localStorage.getItem('currentSession');
            const sessionDetails = document.getElementById('session-details');
            
            if (currentSession) {
                try {
                    const session = JSON.parse(currentSession);
                    sessionDetails.innerHTML = `
                        <div class="success">‚úÖ Sesi√≥n encontrada</div>
                        <p><strong>Usuario:</strong> ${session.nombreCompleto || 'N/A'}</p>
                        <p><strong>Tipo:</strong> ${session.tipoUsuario || 'N/A'}</p>
                        <p><strong>Email:</strong> ${session.correoElectronico || 'N/A'}</p>
                        <p><strong>ID:</strong> ${session.id || 'N/A'}</p>
                    `;
                } catch (error) {
                    sessionDetails.innerHTML = `<div class="error">‚ùå Error al parsear sesi√≥n: ${error.message}</div>`;
                }
            } else {
                sessionDetails.innerHTML = '<div class="error">‚ùå No se encontr√≥ sesi√≥n activa</div>';
            }

            // Informaci√≥n de token
            const authToken = localStorage.getItem('authToken');
            const token = localStorage.getItem('token');
            const tokenDetails = document.getElementById('token-details');
            
            let tokenInfo = [];
            if (authToken) tokenInfo.push(`<div class="success">‚úÖ authToken: ${authToken.substring(0, 20)}...</div>`);
            if (token) tokenInfo.push(`<div class="success">‚úÖ token: ${token.substring(0, 20)}...</div>`);
            
            if (tokenInfo.length === 0) {
                tokenDetails.innerHTML = '<div class="error">‚ùå No se encontraron tokens</div>';
            } else {
                tokenDetails.innerHTML = tokenInfo.join('');
            }

            // Informaci√≥n de usuario registrado
            const registeredUsers = localStorage.getItem('registeredUsers');
            const userDetails = document.getElementById('user-details');
            
            if (registeredUsers) {
                try {
                    const users = JSON.parse(registeredUsers);
                    userDetails.innerHTML = `
                        <div class="success">‚úÖ ${users.length} usuarios registrados</div>
                        <p><strong>Administradores:</strong> ${users.filter(u => u.tipoUsuario === 'administrador').length}</p>
                        <p><strong>Empleados:</strong> ${users.filter(u => u.tipoUsuario === 'empleado').length}</p>
                    `;
                } catch (error) {
                    userDetails.innerHTML = `<div class="error">‚ùå Error al parsear usuarios: ${error.message}</div>`;
                }
            } else {
                userDetails.innerHTML = '<div class="warning">‚ö†Ô∏è No se encontraron usuarios registrados</div>';
            }

            // Mostrar todo el localStorage
            const storageDetails = document.getElementById('storage-details');
            const allStorage = {};
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                allStorage[key] = value;
            }
            
            storageDetails.innerHTML = `<pre>${JSON.stringify(allStorage, null, 2)}</pre>`;
            
            console.log('üìä Diagn√≥stico completado');
            console.log('LocalStorage completo:', allStorage);
        });
    </script>
</body>
</html>